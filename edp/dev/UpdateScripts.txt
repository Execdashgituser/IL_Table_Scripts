UPDATE PROJECT_CATALOG_FACT SET DURATION = period_diff(date_format(DEADLINE_DATE, '%Y%m'), date_format(START_DATE, '%Y%m')) ;
UPDATE PROJECT_CATALOG_FACT SET DURATION_SPENT = period_diff(date_format(DEADLINE_DATE, '%Y%m'), date_format(CURRENT_DATE, '%Y%m'))      ;
UPDATE PROJECT_CATALOG_FACT SET PERCENTAGE_COMPLETE = Case when PERCENTAGE_COMPLETE is null then (DURATION_SPENT/DURATION) else (PERCENTAGE_COMPLETE) End ;

UPDATE PROJECT_CATALOG_FACT SET PR_START_IN_NEXT_6MON = Case when TIMESTAMPDIFF(MONTH,CURRENT_DATE,START_DATE) between 0 and 6  and  TIMESTAMPDIFF(DAY,CURRENT_DATE,START_DATE)>= 0 then 1 else 0 End ;
UPDATE PROJECT_CATALOG_FACT SET PR_END_IN_NEXT_6MON  = Case when (TIMESTAMPDIFF(MONTH,CURRENT_DATE,DEADLINE_DATE) between 0 and 6) and   (TIMESTAMPDIFF(DAY,CURRENT_DATE,DEADLINE_DATE)>= 0) then 1 else 0 End ;
UPDATE PROJECT_CATALOG_FACT SET EST_BUDGET_SPENT = Case when EST_BUDGET_SPENT is null then EST_BUDGET* PERCENTAGE_COMPLETE else EST_BUDGET_SPENT End ;
UPDATE PROJECT_CATALOG_FACT SET PERCENTAGE_SPENT = Case when PERCENTAGE_SPENT is null then  PERCENTAGE_COMPLETE else PERCENTAGE_SPENT End;
UPDATE PROJECT_CATALOG_FACT SET PROJECT_STATUS_NUM = Case when UPPER(PROJECT_STATUS) = 'GREEN' then 3 when UPPER(PROJECT_STATUS) = 'YELLOW' then 2 when UPPER(PROJECT_STATUS) = 'RED' then 1 else 0 End;
UPDATE PROGRAM_DIMENSION SET PROGRAM_STATUS_NUM = Case when UPPER(PROGRAM_STATUS) = 'GREEN' then 3 when UPPER(PROGRAM_STATUS) = 'YELLOW' then 2 when UPPER(PROGRAM_STATUS) = 'RED' then 1 else 0 End;

UPDATE ISSUES_DIMENSION SET CRITICALITY_NUM = Case when UPPER(CRITICALITY) = 'GREEN' then 3 when UPPER(CRITICALITY) = 'YELLOW' then 2 when UPPER(CRITICALITY) = 'RED' then 1 else 0 End;
UPDATE ISSUES_DIMENSION SET IS_DUE_NXT_6MON = Case when (TIMESTAMPDIFF(MONTH,CURRENT_DATE,RESOLUTION_DUE_DATE) between 0 and 6) and   (TIMESTAMPDIFF(DAY,CURRENT_DATE,RESOLUTION_DUE_DATE)>= 0) then 1 else 0 End ;


UPDATE ACTIVITY_DIMENSION SET ACTIVITY_DIMENSION.ACTIVITY_STATUS_NUM = Case when UPPER(ACTIVITY_STATUS_COLOR) = 'GREEN' then 3 when UPPER(ACTIVITY_STATUS_COLOR) = 'YELLOW' then 2 when UPPER(ACTIVITY_STATUS_COLOR) = 'RED' then 1 else 0 End;
UPDATE ACTIVITY_DIMENSION SET ACTIVITY_DIMENSION.ACT_START_IN_NEXT_6MON = Case when (TIMESTAMPDIFF(MONTH,CURRENT_DATE,ACTIVITY_DIMENSION.START_DATE) between 0 and 6) and   (TIMESTAMPDIFF(DAY,CURRENT_DATE,ACTIVITY_DIMENSION.START_DATE)>= 0) then 1 else 0 End ;
UPDATE ACTIVITY_DIMENSION SET ACTIVITY_DIMENSION.ACT_END_IN_NEXT_6MON = Case when (TIMESTAMPDIFF(MONTH,CURRENT_DATE,ACTIVITY_DIMENSION.END_DATE) between 0 and 6) and   (TIMESTAMPDIFF(DAY,CURRENT_DATE,ACTIVITY_DIMENSION.END_DATE)>= 0) then 1 else 0 End ;

UPDATE RISKS_DIMENSION SET CALCULATED_SEVERITY = PROBABILITY * IMPACT  ; 
 

select start_date, deadline_Date,PROJECT_ID,DURATION,DURATION_SPENT,PERCENTAGE_COMPLETE,PERCENTAGE_SPENT,EST_BUDGET,EST_BUDGET_SPENT FROM PROJECT_CATALOG;
UPDATE PROJECT_CATALOG_FACT SET EST_BUDGET_SPENT = EST_BUDGET* PERCENTAGE_SPENT;